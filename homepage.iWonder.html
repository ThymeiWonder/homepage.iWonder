<!DOCTYPE html>
<!-- 
  作者: thyme
  日期: 2025-08-28
  描述: 一个简约的、具有动态背景和多引擎搜索功能的个人主页。
-->
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>homepage.iWonder</title>
    <style>
      /* --- 全局重置和基础样式 --- */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        border: none;
        /* 去除元素聚焦时的默认边框 */
        outline: none;
      }

      body {
        /* 当背景图片不生效时候的默认背景色 */
        background-color: rgba(21, 58, 91, 0.635);
        /* 动态背景图片通过JS设置 */
        background-size: cover;
        /* 图片覆盖整个屏幕 */
        background-repeat: no-repeat;
        /* 图片不重复 */
        background-attachment: fixed;
        /* 背景图片固定，不随滚动条滚动 */
        height: 100vh;
        /* body高度为视口高度 */
        margin: 0;
        font-family: sans-serif;
        /* 默认字体 */
        display: grid;
        /* 使用Grid布局 */
        place-items: center;
        /* 在Grid布局中实现水平和垂直居中 */
      }

      /* --- 搜索框主要样式 --- */
      #search-form {
        width: 36vw;
        /* 宽度为视口宽度的36% */
        height: 46px;
        /* 固定高度 */
        min-width: 300px;
        /* 最小宽度 */
        border: none;
        text-align: center;
        display: grid;
        grid-template-rows: 1fr;
        /* 单行 */
        grid-template-columns: 1fr 15fr 1fr;
        /* 定义三列的比例，用于放置 引擎选择-输入框-搜索按钮 */
        border-radius: 23px;
        /* 圆角 */
        background-color: rgba(
          255,
          255,
          255,
          0.25
        ); /* 降低不透明度以突出玻璃效果 */
        backdrop-filter: blur(10px); /* 玻璃拟态效果 */
        -webkit-backdrop-filter: blur(10px); /* 兼容Safari */
        box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1); /* 柔和的阴影 */
        border: 1px solid rgba(255, 255, 255, 0.18); /* 细微的边框 */
      }

      /* --- 搜索引擎选择器容器 --- */
      #search-engine-container {
        position: relative;
        /* 相对定位，为下拉菜单提供定位上下文 */
        display: grid;
        place-items: center;
      }

      /* --- 当前选中的搜索引擎图标 --- */
      #selected-engine {
        width: 25px;
        height: 25px;
        border-radius: 50%;
        background-color: transparent;
        cursor: pointer;
        /* 鼠标悬停时显示手型光标 */
        display: grid;
        place-items: center;
        transition: background-color 0.2s ease;
      }

      #selected-engine:hover {
        background-color: rgba(255, 255, 255, 0.7);
      }

      /* --- 搜索引擎下拉选项 --- */
      #engine-options {
        position: absolute;
        left: 100%; /* 定位到父元素的右侧 */
        top: 50%;
        transform: translateY(-50%); /* 垂直居中 */
        margin-left: 0px; /* 与主搜索框的间距 */
        display: flex; /* 水平排列图标 */
        gap: 8px; /* 图标之间的间距 */
        padding: 0px;
        border-radius: 23px;
        background-color: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.18);
        z-index: 10;

        /* 动画效果 */
        visibility: hidden; /* 默认不可见，无法交互 */
        opacity: 0;
        transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
      }

      #engine-options.visible {
        /* 可见可交互 */
        visibility: visible;
        opacity: 1;
      }

      /* --- 单个搜索引擎选项 --- */
      .engine-option {
        width: 25px;
        height: 25px;
        cursor: pointer;
        display: grid;
        place-items: center;
        border-radius: 50%;
        transition: background-color 0.2s ease;
        opacity: 0;
        transform: translateX(-10px);
        transition: opacity 0.3s ease, transform 0.3s ease,
          background-color 0.2s ease;
      }

      /* 为每个选项设置不同的延迟时间 */
      /* #engine-options.visible .engine-option:nth-child(1) {
        transition-delay: 0.1s;
      }
      #engine-options.visible .engine-option:nth-child(2) {
        transition-delay: 0.2s;
      }
      #engine-options.visible .engine-option:nth-child(3) {
        transition-delay: 0.3s;
      }
      #engine-options.visible .engine-option:nth-child(4) {
        transition-delay: 0.4s;
      } */

      #engine-options.visible .engine-option {
        opacity: 1;
        transform: translateX(0);
      }

      .engine-option:hover {
        background-color: rgba(255, 255, 255, 0.7);
      }

      /* --- 搜索按钮 --- */
      #search-button {
        border-radius: 23px;
        background-color: transparent;
        cursor: pointer;
        display: grid;
        place-items: center;
        transition: background-color 0.3s ease; /* 添加背景色渐变效果 */
      }

      #search-button:hover {
        background-color: rgba(69, 219, 216, 0.3);
      }

      /* 当设置图标激活时，加深悬停背景色 */
      #search-button.settings-active:hover {
        background-color: rgba(255, 255, 255, 0.3);
        /* background-color: rgba(69, 219, 216, 0.9); */
      }

      /* --- 搜索输入框 --- */
      #search-query {
        background-color: transparent;
        font-size: 17px;
      }

      /* --- 搜索框隐藏/显示控制 --- */
      .search-container {
        will-change: transform, opacity; /* 预通知浏览器，优化动画性能 */
        transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
          transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        opacity: 1;
        transform: translateY(0);
        visibility: visible;
      }
      .search-container.hidden {
        opacity: 0;
        /* 完全透明 */
        visibility: hidden;
        /* 从渲染树中移除，不可交互 */
        transform: translateY(-20px); /* 向上移动20px，实现从上到下的动画效果 */
        transition: opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1),
          transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), visibility 0s linear 0.2s;
      }
    </style>
  </head>

  <body>
    <!-- 搜索框容器，用于整体控制显示和隐藏 -->
    <div class="search-container hidden">
      <form id="search-form">
        <!-- 搜索引擎选择器 -->
        <div id="search-engine-container">
          <!-- 显示当前选中的引擎图标 -->
          <!-- 默认使用的搜索图标 等待被js通过defaultSearchEngine变量自动填充图标内容-->
          <div id="selected-engine"></div>

          <!-- 搜索引擎下拉选项列表 -->
          <div id="engine-options">
            <!-- Bing -->
            <div class="engine-option" data-value="bing">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="22"
                height="22"
                aria-label="Bing"
                role="img"
                viewBox="0 0 512 512">
                <path
                  d="M145,73l73,26V356l103-59-50-24-32-79,162,57v83L218,439l-73-41Z"
                  fill="#008373"></path>
              </svg>
            </div>
            <!-- Baidu -->
            <div class="engine-option" data-value="baidu">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="22"
                height="22"
                aria-label="Baidu"
                role="img"
                viewBox="0 0 512 512">
                <path
                  d="m131 251c41-9 35-58 34-68-2-17-21-45-48-43-33 3-37 50-37 50-5 22 10 70 51 61m76-82c22 0 40-26 40-58s-18-58-40-58c-23 0-41 26-41 58s18 58 41 58m96 4c31 4 50-28 54-53 4-24-16-52-37-57s-48 29-50 52c-3 27 3 54 33 58m120 41c0-12-10-47-46-47s-41 33-41 57c0 22 2 53 47 52s40-51 40-62m-46 102s-46-36-74-75c-36-57-89-34-106-5-18 29-45 48-49 53-4 4-56 33-44 84 11 52 52 51 52 51s30 3 65-5 65 2 65 2 81 27 104-25c22-53-13-80-13-80"
                  fill="#2319dc"></path>
                <path
                  d="m214 266v34h-28s-29 3-39 35c-3 21 4 34 5 36 1 3 10 19 33 23h53v-128zm-1 107h-21s-15-1-19-18c-3-7 0-16 1-20 1-3 6-11 17-14h22zm38-70v68s1 17 24 23h61v-91h-26v68h-25s-8-1-10-7v-61z"
                  fill="#ffffff"></path>
              </svg>
            </div>
            <!-- Google -->
            <div class="engine-option" data-value="google">
              <svg
                width="22"
                height="22"
                viewBox="-1.6 -1.6 19.20 19.20"
                xmlns="http://www.w3.org/2000/svg"
                fill="none">
                <path
                  fill="#4285F4"
                  d="M14.9 8.161c0-.476-.039-.954-.121-1.422h-6.64v2.695h3.802a3.24 3.24 0 01-1.407 2.127v1.75h2.269c1.332-1.22 2.097-3.02 2.097-5.15z"></path>
                <path
                  fill="#34A853"
                  d="M8.14 15c1.898 0 3.499-.62 4.665-1.69l-2.268-1.749c-.631.427-1.446.669-2.395.669-1.836 0-3.393-1.232-3.952-2.888H1.85v1.803A7.044 7.044 0 008.14 15z"></path>
                <path
                  fill="#FBBC04"
                  d="M4.187 9.342a4.17 4.17 0 010-2.68V4.859H1.849a6.97 6.97 0 000 6.286l2.338-1.803z"></path>
                <path
                  fill="#EA4335"
                  d="M8.14 3.77a3.837 3.837 0 012.7 1.05l2.01-1.999a6.786 6.786 0 00-4.71-1.82 7.042 7.042 0 00-6.29 3.858L4.186 6.66c.556-1.658 2.116-2.89 3.952-2.89z"></path>
              </svg>
            </div>
          </div>
        </div>

        <!-- 搜索查询输入框 -->
        <input
          class="item"
          type="text"
          id="search-query"
          autocomplete="off"
          placeholder="i wonder more about you ..."
          autofocus />

        <!-- 搜索提交按钮 -->
        <button class="item" type="submit" id="search-button">
          <!-- 放大镜图标 -->
          <svg
            id="search-icon"
            height="18"
            width="18"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 512 512"
            xml:space="preserve"
            fill="#000000">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g
              id="SVGRepo_tracerCarrier"
              stroke-linecap="round"
              stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <g>
                <path
                  style="fill: #06a0a2"
                  d="M242.832,451.744c-124.528,0-225.84-101.312-225.84-225.872S118.304,0,242.832,0 c124.56,0,225.872,101.312,225.872,225.872S367.392,451.744,242.832,451.744z M242.832,24.848 c-110.816,0-200.992,90.208-200.992,201.024s90.176,201.024,200.992,201.024s201.024-90.208,201.024-201.024 S353.648,24.848,242.832,24.848z"></path>
                <polygon
                  style="fill: #22acdd"
                  points="477.456,512 373.008,407.52 393.936,393.344 495.008,494.432 "></polygon>
              </g>
            </g>
          </svg>
          <!-- 设置图标 (默认隐藏) -->
          <svg
            id="settings-icon"
            style="display: none"
            width="18"
            height="18"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
              d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z"
              stroke="#06a0a2"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round" />
            <path
              d="M19.4 15C19.2669 15.3016 19.2272 15.6362 19.286 15.9606C19.3448 16.285 19.4995 16.5843 19.73 16.82L19.79 16.88C19.976 17.0657 20.1235 17.2863 20.2241 17.5291C20.3248 17.7719 20.3766 18.0322 20.3766 18.295C20.3766 18.5578 20.3248 18.8181 20.2241 19.0609C20.1235 19.3037 19.976 19.5243 19.79 19.71C19.6043 19.896 19.3837 20.0435 19.1409 20.1441C18.8981 20.2448 18.6378 20.2966 18.375 20.2966C18.1122 20.2966 17.8519 20.2448 17.6091 20.1441C17.3663 20.0435 17.1457 19.896 16.96 19.71L16.9 19.65C16.6643 19.4195 16.365 19.2648 16.0406 19.206C15.7162 19.1472 15.3816 19.1869 15.08 19.32C14.7842 19.4468 14.532 19.6572 14.3543 19.9255C14.1766 20.1938 14.0813 20.5082 14.08 20.83V21C14.08 21.5304 13.8693 22.0391 13.4942 22.4142C13.1191 22.7893 12.6104 23 12.08 23C11.5496 23 11.0409 22.7893 10.6658 22.4142C10.2907 22.0391 10.08 21.5304 10.08 21V20.91C10.0723 20.579 9.96512 20.258 9.77251 19.9887C9.5799 19.7194 9.31074 19.5143 9 19.4C8.69838 19.2669 8.36381 19.2272 8.03941 19.286C7.71502 19.3448 7.41568 19.4995 7.18 19.73L7.12 19.79C6.93425 19.976 6.71368 20.1235 6.47088 20.2241C6.22808 20.3248 5.96783 20.3766 5.705 20.3766C5.44217 20.3766 5.18192 20.3248 4.93912 20.2241C4.69632 20.1235 4.47575 19.976 4.29 19.79C4.10405 19.6043 3.95653 19.3837 3.85588 19.1409C3.75523 18.8981 3.70343 18.6378 3.70343 18.375C3.70343 18.1122 3.75523 17.8519 3.85588 17.6091C3.95653 17.3663 4.10405 17.1457 4.29 16.96L4.35 16.9C4.58054 16.6643 4.73519 16.365 4.794 16.0406C4.85282 15.7162 4.81312 15.3816 4.68 15.08C4.55324 14.7842 4.34276 14.532 4.07447 14.3543C3.80618 14.1766 3.49179 14.0813 3.17 14.08H3C2.46957 14.08 1.96086 13.8693 1.58579 13.4942C1.21071 13.1191 1 12.6104 1 12.08C1 11.5496 1.21071 11.0409 1.58579 10.6658C1.96086 10.2907 2.46957 10.08 3 10.08H3.09C3.42099 10.0723 3.742 9.96512 4.0113 9.77251C4.28059 9.5799 4.48572 9.31074 4.6 9C4.73312 8.69838 4.77282 8.36381 4.714 8.03941C4.65519 7.71502 4.50054 7.41568 4.27 7.18L4.21 7.12C4.02405 6.93425 3.87653 6.71368 3.77588 6.47088C3.67523 6.22808 3.62343 5.96783 3.62343 5.705C3.62343 5.44217 3.67523 5.18192 3.77588 4.93912C3.87653 4.69632 4.02405 4.47575 4.21 4.29C4.39575 4.10405 4.61632 3.95653 4.85912 3.85588C5.10192 3.75523 5.36217 3.70343 5.625 3.70343C5.88783 3.70343 6.14808 3.75523 6.39088 3.85588C6.63368 3.95653 6.85425 4.10405 7.04 4.29L7.1 4.35C7.33568 4.58054 7.63502 4.73519 7.95941 4.794C8.28381 4.85282 8.61838 4.81312 8.92 4.68H9C9.29577 4.55324 9.54802 4.34276 9.72569 4.07447C9.90337 3.80618 9.99872 3.49179 10 3.17V3C10 2.46957 10.2107 1.96086 10.5858 1.58579C10.9609 1.21071 11.4696 1 12 1C12.5304 1 13.0391 1.21071 13.4142 1.58579C13.7893 1.96086 14 2.46957 14 3V3.09C14.0013 3.41179 14.0966 3.72618 14.2743 3.99447C14.452 4.26276 14.7042 4.47324 15 4.6C15.3016 4.73312 15.6362 4.77282 15.9606 4.714C16.285 4.65519 16.5843 4.50054 16.82 4.27L16.88 4.21C17.0657 4.02405 17.2863 3.87653 17.5291 3.77588C17.7719 3.67523 18.0322 3.62343 18.295 3.62343C18.5578 3.62343 18.8181 3.67523 19.0609 3.77588C19.3037 3.87653 19.5243 4.02405 19.71 4.21C19.896 4.39575 20.0435 4.61632 20.1441 4.85912C20.2448 5.10192 20.2966 5.36217 20.2966 5.625C20.2966 5.88783 20.2448 6.14808 20.1441 6.39088C20.0435 6.63368 19.896 6.85425 19.71 7.04L19.65 7.1C19.4195 7.33568 19.2648 7.63502 19.206 7.95941C19.1472 8.28381 19.1869 8.61838 19.32 8.92V9C19.4468 9.29577 19.6572 9.54802 19.9255 9.72569C20.1938 9.90337 20.5082 9.99872 20.83 10H21C21.5304 10 22.0391 10.2107 22.4142 10.5858C22.7893 10.9609 23 11.4696 23 12C23 12.5304 22.7893 13.0391 22.4142 13.4142C22.0391 13.7893 21.5304 14 21 14H20.91C20.5882 14.0013 20.2738 14.0966 20.0055 14.2743C19.7372 14.452 19.5268 14.7042 19.4 15Z"
              stroke="#06a0a2"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
        </button>
      </form>
    </div>

    <!-- 这个空的div用于在Grid布局中占位，将搜索框推到屏幕中间偏上的位置 -->
    <div></div>

    <script>
      // #region 自定义设置区
      // 默认设置 - 当localStorage中没有值时将使用这些设置

      const config = {
        // 默认搜索引擎
        defaultSearchEngine: "baidu",
        // 是否显示搜索框
        isDefaultSearchBoxVisible: "yes",
        // imagePath: "F:/000-share/picture/wallpaper/",
        // 背景图绝对路径列表  用户可以在此处自定义背景图片.
        images: [],
      };

      // 从localStorage加载设置，如果不存在则使用默认值并保存
      function loadConfigFromLocalStorage() {
        for (const key in config) {
          if (Object.prototype.hasOwnProperty.call(config, key)) {
            if (key === "images") {
              // 数据量太大, 跳过同步
              continue;
            }
            const element = config[key];
            const savedValue = localStorage.getItem(key);

            if (savedValue == null) {
              localStorage.setItem(key, JSON.stringify(element));
              continue;
            }
            let t = JSON.parse(savedValue);
            if (t.length === 0) {
              localStorage.setItem(key, JSON.stringify(element));
              continue;
            }
            config[key] = t;
          }
        }
        // console.log("Loaded config:", config);
      }

      function configGet(key) {
        return config[key];
      }

      function configSetAndSyncToLocalStorage(key, value) {
        config[key] = value;
        localStorage.setItem(key, JSON.stringify(value));
      }

      // #endregion 自定义设置区

      // #region 常量区
      // --- DOM元素获取 ---
      const searchContainer = document.querySelector(".search-container");
      const searchQuery = document.getElementById("search-query");
      // --- 搜索引擎切换功能 ---
      const selectedEngine = document.getElementById("selected-engine");
      const engineOptions = document.getElementById("engine-options");
      const searchButton = document.getElementById("search-button");
      const searchIcon = document.getElementById("search-icon");
      const settingsIcon = document.getElementById("settings-icon");
      // #endregion 常量区

      // #region  函数区
      // --- 图标切换 ---
      function showSettingsIcon() {
        searchIcon.style.display = "none";
        settingsIcon.style.display = "block";
        searchButton.classList.add("settings-active"); // 添加激活类
      }

      function showSearchIcon() {
        searchIcon.style.display = "block";
        settingsIcon.style.display = "none";
        searchButton.classList.remove("settings-active"); // 移除激活类
      }

      // --- 搜索框显示/隐藏功能 ---

      // 显示搜索框并聚焦到输入框
      function showSearch() {
        if (searchContainer.classList.contains("hidden")) {
          searchQuery.value = "";
          searchContainer.classList.remove("hidden");
          // 更新config并保存状态到localStorage
          configSetAndSyncToLocalStorage("isDefaultSearchBoxVisible", "yes");
        }
        searchQuery.focus();
      }

      // 隐藏搜索框并清空输入内容
      function hideSearch() {
        if (!searchContainer.classList.contains("hidden")) {
          searchContainer.classList.add("hidden");
          // 更新config并保存状态到localStorage
          configSetAndSyncToLocalStorage("isDefaultSearchBoxVisible", "no");
        }
      }

      // --- 动态背景图功能 ---
      function setRandomBackgroundImage(imageNames) {
        // 生成一个随机索引
        const randomIndex = Math.floor(Math.random() * imageNames.length);
        // 根据随机索引获取图片路径
        const imagePath = imageNames[randomIndex];
        // 设置body的背景图片
        document.body.style.backgroundImage = `url('file:///${imagePath}')`;
      }

      // function backgroundImageFolderSelectHandler(event) {
      //   const folderPath = event.target.value;
      //   console.log("Selected folder:", folderPath);
      // }

      // #endregion 函数区

      // #region  事件注册区
      /*
       * 单击右键时:
       * 1. 禁用默认右键菜单.
       * 2. 当搜索框隐藏时, 显示搜索框.
       * 3. 当点击位置在搜索框之外 且 搜索框显示 且 搜索框内无内容时, 隐藏搜索框.
       * 4. 右键点击要有防抖功能. 短时间内的多次点击, 视为一次点击.
       */
      document.addEventListener("contextmenu", (event) => {
        event.preventDefault();
        // 如果点击搜索框本身, 则无需操作.
        if (searchContainer.contains(event.target)) {
          return;
        }
        if (searchContainer.classList.contains("hidden")) {
          // 如果搜索框是隐藏的, 则显示搜索框.
          showSearch();
        } else if (searchQuery.value === "") {
          // 如果搜索框是显示的, 且搜索框内无内容, 则隐藏搜索框.
          hideSearch();
        }
      });

      // 监听全局键盘事件
      document.addEventListener("keydown", (event) => {
        // 如果按下 'Escape' 键，隐藏搜索框
        if (event.key === "Escape") {
          hideSearch();
          return;
        }
        // 否则，显示搜索框
        showSearch();
      });

      // 监听全局点击事件，如果点击位置不在搜索框内，则显示搜索框
      document.addEventListener("click", (event) => {
        if (!searchContainer.contains(event.target)) {
          showSearch();
        }
      });

      // --- 搜索引擎弹出框悬浮/失焦自动隐藏 ---
      const searchEngineContainer = document.getElementById(
        "search-engine-container"
      );
      let engineHideTimeout;
      const startHideTimer = () => {
        engineHideTimeout = setTimeout(
          () => engineOptions.classList.remove("visible"),
          300
        );
      };
      const cancelHideTimer = () => clearTimeout(engineHideTimeout);

      searchEngineContainer.addEventListener("mouseenter", cancelHideTimer);
      searchEngineContainer.addEventListener("mouseleave", startHideTimer);
      engineOptions.addEventListener("mouseenter", cancelHideTimer);
      engineOptions.addEventListener("mouseleave", startHideTimer);

      // 点击当前引擎图标，切换下拉菜单的显示/隐藏
      selectedEngine.addEventListener("click", (event) => {
        event.stopPropagation(); // 阻止事件冒泡，防止触发全局点击事件
        engineOptions.classList.toggle("visible");
      });

      // 为每个引擎选项添加点击事件
      document.querySelectorAll(".engine-option").forEach((option) => {
        option.addEventListener("click", () => {
          // 更新当前引擎
          configSetAndSyncToLocalStorage(
            "defaultSearchEngine",
            option.dataset.value
          );
          selectedEngine.innerHTML = option.innerHTML; // 更新显示的图标
          engineOptions.classList.remove("visible"); // 隐藏下拉菜单
        });
      });

      // 点击页面其他地方，隐藏下拉菜单
      document.addEventListener("click", (event) => {
        if (
          !selectedEngine.contains(event.target) &&
          !engineOptions.contains(event.target)
        ) {
          engineOptions.classList.remove("visible");
        }
      });
      
      // --- 搜索表单提交功能 ---
      document
        .getElementById("search-form")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // 阻止表单默认的提交行为

          const query = document.getElementById("search-query").value;
          // 如果查询内容为空或只有空格，则不执行搜索
          if (!query.trim()) {
            return;
          }

          let searchUrl;

          // 根据当前选择的搜索引擎构建URL
          switch (configGet("defaultSearchEngine")) {
            case "baidu":
              searchUrl = `https://www.baidu.com/s?wd=${encodeURIComponent(
                query
              )}`;
              break;
            case "google":
              searchUrl = `https://www.google.com/search?q=${encodeURIComponent(
                query
              )}`;
              break;
            case "bing":
              searchUrl = `https://www.bing.com/search?q=${encodeURIComponent(
                query
              )}`;
              break;
          }

          // 如果URL构建成功，在新标签页中打开
          if (searchUrl) {
            window.open(searchUrl, "_blank");
          }
        });

      // 页面加载完成后执行
      document.addEventListener("DOMContentLoaded", () => {
        // 首先加载设置
        loadConfigFromLocalStorage();

        // 初始化当前搜索引擎图标
        selectedEngine.innerHTML = searchContainer.querySelector(
          `div[data-value="${configGet("defaultSearchEngine")}"]`
        ).innerHTML;

        // 设置随机背景图片
        setRandomBackgroundImage(configGet("images"));

        // 根据从localStorage加载的设置来决定是否显示搜索框
        if (configGet("isDefaultSearchBoxVisible") === "yes") {
          showSearch();
        } else {
          // 如果设置为不显示，则确保是隐藏状态
          hideSearch();
          searchContainer.classList.add("hidden");
        }
      });

      // --- 搜索按钮右键点击事件 ---
      searchButton.addEventListener("contextmenu", (event) => {
        event.preventDefault(); // 阻止默认右键菜单
        if (settingsIcon.style.display === "none") {
          showSettingsIcon();
        } else {
          showSearchIcon();
        }
      });

      // --- 失焦自动切回搜索图标 ---
      searchButton.addEventListener("mouseleave", () => {
        showSearchIcon();
      });
      // #endregion 事件注册区
    </script>
  </body>
</html>
